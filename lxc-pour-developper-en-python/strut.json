{
  "slides": [
    {
      "components": [
        {
          "src": "https://linuxcontainers.org/static/img/containers.png",
          "type": "Image",
          "x": 360,
          "y": 398,
          "scale": {
            "x": 1,
            "y": 1
          },
          "imageType": "PNG",
          "selected": false
        },
        {
          "src": "https://www.python.org/static/img/python-logo-large.png?1414305901",
          "type": "Image",
          "x": 415,
          "y": 330,
          "scale": {
            "x": 1,
            "y": 1
          },
          "imageType": "PNG",
          "selected": false
        }
      ],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 0,
      "selected": false,
      "active": false,
      "markdown": "LXC pour développer en python\n=============================\n\nLXC: LinuX Containers",
      "x": 160,
      "y": 160
    },
    {
      "components": [],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 1,
      "selected": false,
      "active": false,
      "markdown": "LXC c'est quoi ?\n================\n\n* LXC est un système de conteneurs \n\n* Un conteneur ≃ machine virtuelle légère\n\n  * partage réel (sans pré-allocation) de l'espace disque / mémoire / CPU\n  * meilleurs performances (pas d'émulation)\n\n* même noyaux mais isolation des processus, de la mémoire, du réseau, des fichiers\n\n* https://linuxcontainers.org/ ",
      "x": 434,
      "y": 167,
      "background": "img:https://media.giphy.com/media/9LCF8IwHf2HQY/giphy.gif"
    },
    {
      "components": [],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 2,
      "selected": false,
      "active": false,
      "x": 714,
      "y": 167,
      "markdown": "Python c'est quoi ?\n===================\n\nun groupe de comiques",
      "background": "img:https://media.giphy.com/media/uirZilfaQk85a/giphy.gif"
    },
    {
      "components": [],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 3,
      "selected": true,
      "active": true,
      "markdown": "LXC ou Docker ?\n===============\n\n* LXC :\n\n  * plus simple à comprendre\n  * périmètre plus restreint mais facile à combiner à d'autres outils\n\n* Docker :\n\n  * univers plus important et un peu plus complexe\n  * plus d'avantages techniques (gestion simple des liens réseau, images installables…)\n  * a un joli logo\n\n* Les deux \n\n  * sont mûrs et bien supportés\n  * s'appuyent sur les mêmes mécanismes du noyau",
      "x": 985,
      "y": 167,
      "background": "img:https://media.giphy.com/media/ZE6dnP8Yw6X16/giphy.gif"
    },
    {
      "components": [],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 4,
      "selected": false,
      "active": false,
      "markdown": "LXC ou Virtualenv ?\n===================\n\n* Utiliser virtualenv quand:\n\n  * il y a seulement des dépendances de librairies python \n    ex: librairie python, projet web simple\n\n* Utiliser LXC quand:\n\n  * il y a des dépendances systèmes lourdes\n\n    * nodejs, version de python spécifique\n    * numpy et consort…\n\n  * il y a des outils externes:\n\n    * frontal\n    * serveur de BDD, NoSQL\n    * serveur de cache, d'indexation\n    * message broker\n \n  * on veut se rapprocher d'un setup de production\n",
      "x": 988,
      "y": 367,
      "background": "img:https://media.giphy.com/media/V6iCjFGMbGLEQ/giphy.gif"
    },
    {
      "components": [],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 5,
      "selected": false,
      "active": false,
      "markdown": "LXC commandes\n=============\n\n* avec ou sans `sudo` (voir plus loin, espace utilisateur)\n\n* liste des containers avec état et ip:\n  `lxc-ls -f`\n* création (les options de la template sont après un `--`):\n  `lxc-create -n moncontainer -t download`\n  \n* démarrer:\n  `lxc-start -n moncontainer`\n* arréter:\n  `lxc-stop -n moncontainer`\n* exécuter une commande directement (en `root` dans le container, ici bash)\n  `lxc-attach -n moncontainer bash`\n* se connecter à une console (alternative à ssh):\n  `lxc-console -n moncontainer`\n",
      "x": 994,
      "y": 562,
      "background": "img:https://media.giphy.com/media/10TKRuZw4UQuI/giphy.gif"
    },
    {
      "components": [],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 6,
      "selected": false,
      "active": false,
      "markdown": "Dans ton LXC\n=============\n\n* `apt install`, en veux tu, en voilà\n* `sudo pip3 install` comme tu veux\n* installe la version de l'OS ton choix (attention à la compatibilité noyau)\n* ```./manage runserver 0:8000``` ➔ http://moncontainer.lxc:8000/\n* j'utilise git en dehors du container\n",
      "x": 998,
      "y": 751,
      "background": "img:https://media.giphy.com/media/ftGTY1fO9ARUI/giphy.gif"
    },
    {
      "components": [],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 7,
      "selected": false,
      "active": false,
      "markdown": "Partager le home\n=================\n\n* `bindfs` est la solution qui me semble la plus simple et efficace.\n  ```bash\n  $ sudo bindfs /home/alex/.local/share/lxc/moncontainer/rootfs/home/ubuntu/ \\\n    /home/alex/lxc/moncontainer  --map=166536/alex:@166536/@alex\n  ```\n* autre solution: le home dans le container (`/home/ubuntu`)\n  est un montage d'un dossier hors container (via `~/.local/share/lxc/moncontainer/fstab`)\n  Attention sur ubuntu il faut utiliser le profil de sécurité adéquat:\n  ```ini\n  lxc.aa_profile = lxc-container-default-with-mounting\n  ```",
      "x": 739,
      "y": 758,
      "background": "img:https://media.giphy.com/media/kZYHrYwukDulG/giphy.gif"
    },
    {
      "components": [],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 8,
      "selected": false,
      "active": false,
      "markdown": "LXC espace utilisateur\n======================\n\n* voir https://linuxcontainers.org/fr/lxc/getting-started/\n* sur ubuntu, paquet **lxc**\n* ```bash\n  $ cat /etc/lxc/lxc-usernet\n  # USERNAME TYPE BRIDGE COUNT\n  alex veth lxcbr0 10\n  ```\n* ```bash\n  $ cat /etc/subuid\n  alex:165536:65536\n  $ cat /etc/subgid\n  alex:165536:65536\n   ```\n* ```bash\n  $ mkdir ~/.config/lxc\n  $ cp /etc/lxc/default.conf ~/.config/lxc/default.conf\n  $ cat >>/etc/lxc/default.conf <<END\n    lxc.id_map = u 0 100000 65536\n    lxc.id_map = g 0 100000 65536\n    END\n  ```\n* ```bash\n  setfacl -m u:100000:rx /home/alex/{,.local{,/share{,/lxc}}}\n  ```\n\n",
      "x": 472,
      "y": 760,
      "background": "img:https://media.giphy.com/media/ttCbi8U3Exriw/giphy.gif"
    },
    {
      "components": [],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 9,
      "selected": false,
      "active": false,
      "markdown": "Résolution de noms\n==================\n\n* En théorie dnsmask peut gérer les noms lxc:\n  ```bash\n  $ # enable lxc dnsmasq and bind to lxcbr0\n  $ cat /etc/lxc-net\n    ...\n    LXC_DOMAIN=\"lxc\"\n  $ cat /etc/dnsmasq.d/lxc \n    bind-interfaces\n    except-interface=lxcbr0\n  $ # add lxc dns to networkmanager dns list\n  $ cat /etc/NetworkManager/dnsmasq.d/lxc.conf \n    server=/lxc/10.0.3.1\n  $ # you can event add aliases\n  $ cat /etc/NetworkManager/dnsmasq.d/moncontainer-alias \n    cname=sous.moncontainer.lxc,moncontainer.lxc\n  ```\n\n* En pratique dnsmasq semble perdre la mémoire après mise en veille…\n  j'utilise donc un bon vieux `/etc/host`, les ips des containers étant stables\n\n",
      "x": 159,
      "y": 755,
      "background": "img:https://media.giphy.com/media/7aGkF11EUpvkQ/giphy.gif"
    },
    {
      "components": [],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 10,
      "selected": false,
      "active": false,
      "markdown": "Astuces\n=======\n\n* pour copier : `rsync -ap --numeric-ids`\n* `lxc-freeze` et `lxc-unfreeze` pour mettre en pause\n* si besoin du ssh-agent dans le container, passer par un session ssh\n* accès à un port localhost depuis l'extérieur ssh + port forwarding ou règle iptables",
      "x": 162,
      "y": 566,
      "background": "img:https://media.giphy.com/media/13ScR58SFUcFVe/giphy.gif"
    },
    {
      "components": [],
      "z": 0,
      "impScale": 3,
      "rotateX": 0,
      "rotateY": 0,
      "rotateZ": 0,
      "index": 11,
      "selected": false,
      "active": false,
      "markdown": "Merci\n=====\n\nalex -AT- garel -POINT- org\nhttp://jurismarches.com",
      "background": "img:https://media.giphy.com/media/tayDCO2Wuphi8/giphy.gif",
      "x": 161,
      "y": 370
    }
  ],
  "activeSlide": {
    "components": [],
    "z": 0,
    "impScale": 3,
    "rotateX": 0,
    "rotateY": 0,
    "rotateZ": 0,
    "index": 3,
    "selected": true,
    "active": true,
    "markdown": "LXC ou Docker ?\n===============\n\n* LXC :\n\n  * plus simple à comprendre\n  * périmètre plus restreint mais facile à combiner à d'autres outils\n\n* Docker :\n\n  * univers plus important et un peu plus complexe\n  * plus d'avantages techniques (gestion simple des liens réseau, images installables…)\n  * a un joli logo\n\n* Les deux \n\n  * sont mûrs et bien supportés\n  * s'appuyent sur les mêmes mécanismes du noyau",
    "x": 985,
    "y": 167,
    "background": "img:https://media.giphy.com/media/ZE6dnP8Yw6X16/giphy.gif"
  },
  "fileName": "lxc pour dév en python",
  "customStylesheet": ".strut-surface .themedArea h1, .strut-surface .themedArea h2, .strut-surface .themedArea h3, .strut-surface .themedArea h4, .strut-surface .themedArea h5, .strut-surface .themedArea h6{\n  color: #742525;\n}\n\n.strut-surface .themedArea h1 {\n  font-size: 2em;\n}\n.strut-surface .themedArea{\n  color: #CBEF6A;\n}\n.strut-surface .themedArea pre {\n  background: rgba(0,0,0,.5);\n  border-radius: .5em;\n  padding: .5em;\n}\n.strut-surface .themedArea code {\n    font-family: monospace;\n    font-size: .9em;\n    color: #89f069;\n}\n.strut-surface .themedArea > ul:hover, .strut-surface .themedArea > p:hover {\n    background: rgba(0,0,0,.7);\n}\n.strut-surface .themedArea ul {\n  margin-left: 0;\n}\n.strut-surface .themedArea li {\n  margin-left: 1em;\n}\n.strut-surface .themedArea a {\n\tcolor: #7adff5;\n\ttext-decoration: none;\n}",
  "deckVersion": "1.0",
  "customBackgrounds": {
    "bgs": []
  },
  "overviewX": 578.5,
  "overviewY": 460
}
